assign(paste("PAML", "estimatedTau", paste(toString(IGC.geo), ".0", sep = ""), "LocalTree", toString(localtree), "summary", sep = "_"), summary_mat)}
}
# Read in new PAML results
data.path <- paste(paralog, "",sep = "/")
for (IGC.geo in IGC.geo.list){
summary_mat <- NULL
IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "estimatedTau", "paml", "unrooted", "1stTree", "summary.txt", sep = "_")
for (sim.num in 0:(num.sim - 1)){
summary_file <- paste(paml.path, file.name, sep = "")
if (file.exists(summary_file)){
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
}
}
assign(paste("PAML", "estimatedTau", paste(toString(IGC.geo), ".0", sep = ""), "1stTree", "summary", sep = "_"), summary_mat)
}
for (IGC.geo in IGC.geo.list){
summary_mat <- NULL
IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "estimatedTau", "paml", "unrooted", "2ndTree", "summary.txt", sep = "_")
for (sim.num in 0:(num.sim - 1)){
summary_file <- paste(paml.path, file.name, sep = "")
if (file.exists(summary_file)){
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
}
}
assign(paste("PAML", "estimatedTau", paste(toString(IGC.geo), ".0", sep = ""), "2ndTree", "summary", sep = "_"), summary_mat)
}
# for (IGC.geo in IGC.geo.list){
#   summary_mat <- NULL
#   IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
#   file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "10Tau", "paml", "unrooted", "1stTree", "summary.txt", sep = "_")
#   for (sim.num in 0:(num.sim - 1)){
#     summary_file <- paste(paml.path, file.name, sep = "")
#     if (file.exists(summary_file)){
#       all <- readLines(summary_file, n = -1)
#       col.names <- strsplit(all[1], ' ')[[1]][-1]
#       row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
#       summary_mat <- as.matrix(read.table(summary_file,
#                                           row.names = row.names,
#                                           col.names = col.names))
#
#     }
#   }
#   assign(paste("PAML", "10Tau", paste(toString(IGC.geo), ".0", sep = ""), "1stTree", "summary", sep = "_"), summary_mat)
# }
#
# for (IGC.geo in IGC.geo.list){
#   summary_mat <- NULL
#   IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
#   file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "10Tau", "paml", "unrooted", "2ndTree", "summary.txt", sep = "_")
#   for (sim.num in 0:(num.sim - 1)){
#     summary_file <- paste(paml.path, file.name, sep = "")
#     if (file.exists(summary_file)){
#       all <- readLines(summary_file, n = -1)
#       col.names <- strsplit(all[1], ' ')[[1]][-1]
#       row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
#       summary_mat <- as.matrix(read.table(summary_file,
#                                           row.names = row.names,
#                                           col.names = col.names))
#
#     }
#   }
#   assign(paste("PAML", "10Tau", paste(toString(IGC.geo), ".0", sep = ""), "2ndTree", "summary", sep = "_"), summary_mat)
# }
#
# save.image("/Users/xji3/GitFolders/IGCCodonSimulation/All.RData")
sum(PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_1_summary["ll",] < 0)
sum(PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_2_summary["ll",] < 0)
sum(PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_3_summary["ll",] < 0)
hist((PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_1_summary["ll",])[PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_1_summary["ll",] < 0],
main = "lnL difference - local tree 1",
xlab = "lnL difference")
hist((PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_2_summary["ll",])[PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_2_summary["ll",] < 0],
main = "lnL difference - local tree 2",
xlab = "lnL difference")
hist((PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_3_summary["ll",])[PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_3_summary["ll",] < 0],
main = "lnL difference - local tree 3",
xlab = "lnL difference")
# OK, more check
sum(PAML_3.0_summary[4, ] < 5e-6 & PAML_3.0_summary[6, ] > 5e-6 )
sum(PAML_3.0_summary[4, ] > 5e-6 & PAML_3.0_summary[6, ] < 5e-6 )
# No asymmetry in the 0 branch length estimates
convert.summary <- function(localTree, summary, vector.names){
new.summary <- vector("numeric", length(vector.names))
names(new.summary) <- vector.names
if (localTree == 1){
new.summary[1:3] <- summary[1:3]
new.summary["N0_N6"] <- summary["N0_N5"]
new.summary["N0_kluyveriYDR418W"] <- summary["N0_kluyveriYDR418W"]
new.summary["N0_N1"] <- 0.0
new.summary["N1_N2"] <- summary["N0_N1"]
new.summary["N1_castelliiYDR418W"] <- summary["N0_castelliiYDR418W"]
new.summary["N2_bayanusYDR418W"] <- summary["N1_bayanusYDR418W"]
new.summary["N2_N3"] <- summary["N1_N2"]
new.summary["N3_N4"] <- summary["N2_N3"]
new.summary["N3_kudriavzeviiYDR418W"] <- summary["N2_kudriavzeviiYDR418W"]
new.summary["N4_N5"] <- summary["N3_N4"]
new.summary["N4_mikataeYDR418W"] <- summary["N3_mikataeYDR418W"]
new.summary["N5_paradoxusYDR418W"] <- summary["N4_paradoxusYDR418W"]
new.summary["N5_cerevisiaeYDR418W"] <- summary["N4_cerevisiaeYDR418W"]
new.summary["N6_N7"] <- summary["N5_N6"]
new.summary["N6_castelliiYEL054C"] <- summary["N5_castelliiYEL054C"]
new.summary["N7_N8"] <- summary["N6_N7"]
new.summary["N7_bayanusYEL054C"] <- summary["N6_bayanusYEL054C"]
new.summary["N8_N9"] <- summary["N7_N8"]
new.summary["N8_kudriavzeviiYEL054C"] <- summary["N7_kudriavzeviiYEL054C"]
new.summary["N9_mikataeYEL054C"] <- summary["N8_mikataeYEL054C"]
new.summary["N9_N10"] <- summary["N8_N9"]
new.summary["N10_paradoxusYEL054C"] <- summary["N9_paradoxusYEL054C"]
new.summary["N10_cerevisiaeYEL054C"] <- summary["N9_cerevisiaeYEL054C"]
}
else if (localTree == 2){
new.summary[1:3] <- summary[1:3]
new.summary["N0_N6"] <- 0.0
new.summary["N0_kluyveriYDR418W"] <- summary["N0_kluyveriYDR418W"]
new.summary["N0_N1"] <- summary["N0_N1"]
new.summary["N1_N2"] <- summary["N1_N2"]
new.summary["N1_castelliiYDR418W"] <- summary["N1_castelliiYDR418W"]
new.summary["N2_bayanusYDR418W"] <- summary["N2_bayanusYDR418W"]
new.summary["N2_N3"] <- summary["N2_N3"]
new.summary["N3_N4"] <- summary["N3_N4"]
new.summary["N3_kudriavzeviiYDR418W"] <- summary["N3_kudriavzeviiYDR418W"]
new.summary["N4_N5"] <- summary["N4_N5"]
new.summary["N4_mikataeYDR418W"] <- summary["N4_mikataeYDR418W"]
new.summary["N5_paradoxusYDR418W"] <- summary["N5_paradoxusYDR418W"]
new.summary["N5_cerevisiaeYDR418W"] <- summary["N5_cerevisiaeYDR418W"]
new.summary["N6_N7"] <- summary["N0_N6"]
new.summary["N6_castelliiYEL054C"] <- summary["N0_castelliiYEL054C"]
new.summary["N7_N8"] <- summary["N6_N7"]
new.summary["N7_bayanusYEL054C"] <- summary["N6_bayanusYEL054C"]
new.summary["N8_N9"] <- summary["N7_N8"]
new.summary["N8_kudriavzeviiYEL054C"] <- summary["N7_kudriavzeviiYEL054C"]
new.summary["N9_mikataeYEL054C"] <- summary["N8_mikataeYEL054C"]
new.summary["N9_N10"] <- summary["N8_N9"]
new.summary["N10_paradoxusYEL054C"] <- summary["N9_paradoxusYEL054C"]
new.summary["N10_cerevisiaeYEL054C"] <- summary["N9_cerevisiaeYEL054C"]
}
else if (localTree == 3){
new.summary[1:3] <- summary[1:3]
new.summary["N0_N6"] <- 0.0
new.summary["N0_kluyveriYDR418W"] <- summary["N0_kluyveriYDR418W"]
new.summary["N0_N1"] <- 0.0
new.summary["N1_N2"] <- summary["N0_N1"]
new.summary["N1_castelliiYDR418W"] <- summary["N0_castelliiYDR418W"]
new.summary["N2_bayanusYDR418W"] <- summary["N1_bayanusYDR418W"]
new.summary["N2_N3"] <- summary["N1_N2"]
new.summary["N3_N4"] <- summary["N2_N3"]
new.summary["N3_kudriavzeviiYDR418W"] <- summary["N2_kudriavzeviiYDR418W"]
new.summary["N4_N5"] <- summary["N3_N4"]
new.summary["N4_mikataeYDR418W"] <- summary["N3_mikataeYDR418W"]
new.summary["N5_paradoxusYDR418W"] <- summary["N4_paradoxusYDR418W"]
new.summary["N5_cerevisiaeYDR418W"] <- summary["N4_cerevisiaeYDR418W"]
new.summary["N6_N7"] <- summary["N0_N5"]
new.summary["N6_castelliiYEL054C"] <- summary["N0_castelliiYEL054C"]
new.summary["N7_N8"] <- summary["N5_N6"]
new.summary["N7_bayanusYEL054C"] <- summary["N5_bayanusYEL054C"]
new.summary["N8_N9"] <- summary["N6_N7"]
new.summary["N8_kudriavzeviiYEL054C"] <- summary["N6_kudriavzeviiYEL054C"]
new.summary["N9_mikataeYEL054C"] <- summary["N7_mikataeYEL054C"]
new.summary["N9_N10"] <- summary["N7_N8"]
new.summary["N10_paradoxusYEL054C"] <- summary["N8_paradoxusYEL054C"]
new.summary["N10_cerevisiaeYEL054C"] <- summary["N8_cerevisiaeYEL054C"]
}
else if (localTree == 4){
new.summary[vector.names] <- summary[vector.names]
}
return (new.summary)
}
for (IGC.geo in IGC.geo.list){
max.lnL.summary <- NULL
vector.names = rownames(get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = "")))
for (sim.num in 1:100){
max.pos <- which.max(c(get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_LocalTree_1_summary", sep = ""))["ll", sim.num],
get(paste("PAML_estimatedTau_",paste(toString(IGC.geo), ".0", sep = ""), "_LocalTree_2_summary", sep = ""))["ll", sim.num],
get(paste("PAML_estimatedTau_",paste(toString(IGC.geo), ".0", sep = ""), "_LocalTree_3_summary", sep = ""))["ll", sim.num],
get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = ""))["ll", sim.num]))
if (max.pos < 4){
new.summary <- convert.summary(max.pos, get(paste("PAML_estimatedTau", paste(toString(IGC.geo), ".0", sep = ""), "LocalTree", toString(max.pos), "summary", sep = "_"))[, sim.num])
}
else{
new.summary <- get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = ""))[, sim.num]
}
max.lnL.summary <- cbind(max.lnL.summary, new.summary)
}
row.names(max.lnL.summary) <- row.names(get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = "")))
assign(paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "PAML", "maxlnL", "summary", sep = "_"), max.lnL.summary)
}
# Now check asymmetry again
# N4_N5
compare.mean.N4.N5.result <- matrix(c(mean(geo_3.0_PAML_maxlnL_summary["N4_N5", ]),
mean(geo_3.0_PAML_maxlnL_summary["N9_N10",]),
mean(geo_3.0_PAML_maxlnL_summary["N4_N5",])/mean(geo_3.0_PAML_maxlnL_summary["N9_N10",]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N4_N5", ]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N9_N10", ]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N4_N5", ])/mean(PAML_estimatedTau_3.0_1stTree_summary["N9_N10", ])),
2, 3, byrow = TRUE)
colnames(compare.mean.N4.N5.result) <- c("paralog1", "paralog2", "paralog1 / paralog2")
rownames(compare.mean.N4.N5.result) <- c("NEW", "old")
compare.sd.N4.N5.result <- matrix(c(sd(geo_3.0_PAML_maxlnL_summary["N4_N5", ]),
sd(geo_3.0_PAML_maxlnL_summary["N9_N10",]),
sd(geo_3.0_PAML_maxlnL_summary["N4_N5",])/sd(geo_3.0_PAML_maxlnL_summary["N9_N10",]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N4_N5", ]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N9_N10", ]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N4_N5", ])/sd(PAML_estimatedTau_3.0_1stTree_summary["N9_N10", ])),
2, 3, byrow = TRUE)
colnames(compare.sd.N4.N5.result) <- c("paralog1", "paralog2", "paralog1 / paralog2")
rownames(compare.sd.N4.N5.result) <- c("NEW", "old")
# N4_mikatae
compare.mean.N4.mikatae.result <- matrix(c(mean(geo_3.0_PAML_maxlnL_summary["N4_mikataeYDR418W", ]),
mean(geo_3.0_PAML_maxlnL_summary["N9_mikataeYEL054C",]),
mean(geo_3.0_PAML_maxlnL_summary["N4_mikataeYDR418W",])/mean(geo_3.0_PAML_maxlnL_summary["N9_mikataeYEL054C",]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N4_mikataeYDR418W", ]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N9_mikataeYEL054C", ]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N4_mikataeYDR418W", ])/mean(PAML_estimatedTau_3.0_1stTree_summary["N9_mikataeYEL054C", ])),
2, 3, byrow = TRUE)
colnames(compare.mean.N4.mikatae.result) <- c("paralog1", "paralog2", "paralog1 / paralog2")
rownames(compare.mean.N4.mikatae.result) <- c("NEW", "old")
compare.sd.N4.mikatae.result <- matrix(c(sd(geo_3.0_PAML_maxlnL_summary["N4_mikataeYDR418W", ]),
sd(geo_3.0_PAML_maxlnL_summary["N9_mikataeYEL054C",]),
sd(geo_3.0_PAML_maxlnL_summary["N4_mikataeYDR418W",])/sd(geo_3.0_PAML_maxlnL_summary["N9_mikataeYEL054C",]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N4_mikataeYDR418W", ]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N9_mikataeYEL054C", ]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N4_mikataeYDR418W", ])/sd(PAML_estimatedTau_3.0_1stTree_summary["N9_mikataeYEL054C", ])),
2, 3, byrow = TRUE)
colnames(compare.sd.N4.mikatae.result) <- c("paralog1", "paralog2", "paralog1 / paralog2")
rownames(compare.sd.N4.mikatae.result) <- c("NEW", "old")
compare.mean.N4.N5.result
compare.sd.N4.N5.result
compare.mean.N4.mikatae.result
compare.sd.N4.mikatae.result
convert.summary <- function(localTree, summary, vector.names){
new.summary <- vector("numeric", length(vector.names))
names(new.summary) <- vector.names
if (localTree == 1){
new.summary[1:3] <- summary[1:3]
new.summary["N0_N6"] <- summary["N0_N5"]
new.summary["N0_kluyveriYDR418W"] <- summary["N0_kluyveriYDR418W"]
new.summary["N0_N1"] <- 0.0
new.summary["N1_N2"] <- summary["N0_N1"]
new.summary["N1_castelliiYDR418W"] <- summary["N0_castelliiYDR418W"]
new.summary["N2_bayanusYDR418W"] <- summary["N1_bayanusYDR418W"]
new.summary["N2_N3"] <- summary["N1_N2"]
new.summary["N3_N4"] <- summary["N2_N3"]
new.summary["N3_kudriavzeviiYDR418W"] <- summary["N2_kudriavzeviiYDR418W"]
new.summary["N4_N5"] <- summary["N3_N4"]
new.summary["N4_mikataeYDR418W"] <- summary["N3_mikataeYDR418W"]
new.summary["N5_paradoxusYDR418W"] <- summary["N4_paradoxusYDR418W"]
new.summary["N5_cerevisiaeYDR418W"] <- summary["N4_cerevisiaeYDR418W"]
new.summary["N6_N7"] <- summary["N5_N6"]
new.summary["N6_castelliiYEL054C"] <- summary["N5_castelliiYEL054C"]
new.summary["N7_N8"] <- summary["N6_N7"]
new.summary["N7_bayanusYEL054C"] <- summary["N6_bayanusYEL054C"]
new.summary["N8_N9"] <- summary["N7_N8"]
new.summary["N8_kudriavzeviiYEL054C"] <- summary["N7_kudriavzeviiYEL054C"]
new.summary["N9_mikataeYEL054C"] <- summary["N8_mikataeYEL054C"]
new.summary["N9_N10"] <- summary["N8_N9"]
new.summary["N10_paradoxusYEL054C"] <- summary["N9_paradoxusYEL054C"]
new.summary["N10_cerevisiaeYEL054C"] <- summary["N9_cerevisiaeYEL054C"]
}
else if (localTree == 2){
new.summary[1:3] <- summary[1:3]
new.summary["N0_N6"] <- 0.0
new.summary["N0_kluyveriYDR418W"] <- summary["N0_kluyveriYDR418W"]
new.summary["N0_N1"] <- summary["N0_N1"]
new.summary["N1_N2"] <- summary["N1_N2"]
new.summary["N1_castelliiYDR418W"] <- summary["N1_castelliiYDR418W"]
new.summary["N2_bayanusYDR418W"] <- summary["N2_bayanusYDR418W"]
new.summary["N2_N3"] <- summary["N2_N3"]
new.summary["N3_N4"] <- summary["N3_N4"]
new.summary["N3_kudriavzeviiYDR418W"] <- summary["N3_kudriavzeviiYDR418W"]
new.summary["N4_N5"] <- summary["N4_N5"]
new.summary["N4_mikataeYDR418W"] <- summary["N4_mikataeYDR418W"]
new.summary["N5_paradoxusYDR418W"] <- summary["N5_paradoxusYDR418W"]
new.summary["N5_cerevisiaeYDR418W"] <- summary["N5_cerevisiaeYDR418W"]
new.summary["N6_N7"] <- summary["N0_N6"]
new.summary["N6_castelliiYEL054C"] <- summary["N0_castelliiYEL054C"]
new.summary["N7_N8"] <- summary["N6_N7"]
new.summary["N7_bayanusYEL054C"] <- summary["N6_bayanusYEL054C"]
new.summary["N8_N9"] <- summary["N7_N8"]
new.summary["N8_kudriavzeviiYEL054C"] <- summary["N7_kudriavzeviiYEL054C"]
new.summary["N9_mikataeYEL054C"] <- summary["N8_mikataeYEL054C"]
new.summary["N9_N10"] <- summary["N8_N9"]
new.summary["N10_paradoxusYEL054C"] <- summary["N9_paradoxusYEL054C"]
new.summary["N10_cerevisiaeYEL054C"] <- summary["N9_cerevisiaeYEL054C"]
}
else if (localTree == 3){
new.summary[1:3] <- summary[1:3]
new.summary["N0_N6"] <- 0.0
new.summary["N0_kluyveriYDR418W"] <- summary["N0_kluyveriYDR418W"]
new.summary["N0_N1"] <- 0.0
new.summary["N1_N2"] <- summary["N0_N1"]
new.summary["N1_castelliiYDR418W"] <- summary["N0_castelliiYDR418W"]
new.summary["N2_bayanusYDR418W"] <- summary["N1_bayanusYDR418W"]
new.summary["N2_N3"] <- summary["N1_N2"]
new.summary["N3_N4"] <- summary["N2_N3"]
new.summary["N3_kudriavzeviiYDR418W"] <- summary["N2_kudriavzeviiYDR418W"]
new.summary["N4_N5"] <- summary["N3_N4"]
new.summary["N4_mikataeYDR418W"] <- summary["N3_mikataeYDR418W"]
new.summary["N5_paradoxusYDR418W"] <- summary["N4_paradoxusYDR418W"]
new.summary["N5_cerevisiaeYDR418W"] <- summary["N4_cerevisiaeYDR418W"]
new.summary["N6_N7"] <- summary["N0_N5"]
new.summary["N6_castelliiYEL054C"] <- summary["N0_castelliiYEL054C"]
new.summary["N7_N8"] <- summary["N5_N6"]
new.summary["N7_bayanusYEL054C"] <- summary["N5_bayanusYEL054C"]
new.summary["N8_N9"] <- summary["N6_N7"]
new.summary["N8_kudriavzeviiYEL054C"] <- summary["N6_kudriavzeviiYEL054C"]
new.summary["N9_mikataeYEL054C"] <- summary["N7_mikataeYEL054C"]
new.summary["N9_N10"] <- summary["N7_N8"]
new.summary["N10_paradoxusYEL054C"] <- summary["N8_paradoxusYEL054C"]
new.summary["N10_cerevisiaeYEL054C"] <- summary["N8_cerevisiaeYEL054C"]
}
else if (localTree == 4){
new.summary[vector.names] <- summary[vector.names]
}
return (new.summary)
}
for (IGC.geo in IGC.geo.list){
max.lnL.summary <- NULL
vector.names = rownames(get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = "")))
for (sim.num in 1:100){
max.pos <- which.max(c(get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_LocalTree_1_summary", sep = ""))["ll", sim.num],
get(paste("PAML_estimatedTau_",paste(toString(IGC.geo), ".0", sep = ""), "_LocalTree_2_summary", sep = ""))["ll", sim.num],
get(paste("PAML_estimatedTau_",paste(toString(IGC.geo), ".0", sep = ""), "_LocalTree_3_summary", sep = ""))["ll", sim.num],
get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = ""))["ll", sim.num]))
if (max.pos < 4){
new.summary <- convert.summary(max.pos, get(paste("PAML_estimatedTau", paste(toString(IGC.geo), ".0", sep = ""), "LocalTree", toString(max.pos), "summary", sep = "_"))[, sim.num], vector.names)
}
else{
new.summary <- get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = ""))[, sim.num], vector.names
}
max.lnL.summary <- cbind(max.lnL.summary, new.summary)
}
row.names(max.lnL.summary) <- row.names(get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = "")))
sum(PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_1_summary["ll",] < 0)
sum(PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_2_summary["ll",] < 0)
sum(PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_3_summary["ll",] < 0)
hist((PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_1_summary["ll",])[PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_1_summary["ll",] < 0],
main = "lnL difference - local tree 1",
xlab = "lnL difference")
hist((PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_2_summary["ll",])[PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_2_summary["ll",] < 0],
main = "lnL difference - local tree 2",
xlab = "lnL difference")
hist((PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_3_summary["ll",])[PAML_estimatedTau_3.0_1stTree_summary["ll",] - PAML_estimatedTau_3.0_LocalTree_3_summary["ll",] < 0],
main = "lnL difference - local tree 3",
xlab = "lnL difference")
# OK, more check
sum(PAML_3.0_summary[4, ] < 5e-6 & PAML_3.0_summary[6, ] > 5e-6 )
sum(PAML_3.0_summary[4, ] > 5e-6 & PAML_3.0_summary[6, ] < 5e-6 )
# No asymmetry in the 0 branch length estimates
convert.summary <- function(localTree, summary, vector.names){
new.summary <- vector("numeric", length(vector.names))
names(new.summary) <- vector.names
if (localTree == 1){
new.summary[1:3] <- summary[1:3]
new.summary["N0_N6"] <- summary["N0_N5"]
new.summary["N0_kluyveriYDR418W"] <- summary["N0_kluyveriYDR418W"]
new.summary["N0_N1"] <- 0.0
new.summary["N1_N2"] <- summary["N0_N1"]
new.summary["N1_castelliiYDR418W"] <- summary["N0_castelliiYDR418W"]
new.summary["N2_bayanusYDR418W"] <- summary["N1_bayanusYDR418W"]
new.summary["N2_N3"] <- summary["N1_N2"]
new.summary["N3_N4"] <- summary["N2_N3"]
new.summary["N3_kudriavzeviiYDR418W"] <- summary["N2_kudriavzeviiYDR418W"]
new.summary["N4_N5"] <- summary["N3_N4"]
new.summary["N4_mikataeYDR418W"] <- summary["N3_mikataeYDR418W"]
new.summary["N5_paradoxusYDR418W"] <- summary["N4_paradoxusYDR418W"]
new.summary["N5_cerevisiaeYDR418W"] <- summary["N4_cerevisiaeYDR418W"]
new.summary["N6_N7"] <- summary["N5_N6"]
new.summary["N6_castelliiYEL054C"] <- summary["N5_castelliiYEL054C"]
new.summary["N7_N8"] <- summary["N6_N7"]
new.summary["N7_bayanusYEL054C"] <- summary["N6_bayanusYEL054C"]
new.summary["N8_N9"] <- summary["N7_N8"]
new.summary["N8_kudriavzeviiYEL054C"] <- summary["N7_kudriavzeviiYEL054C"]
new.summary["N9_mikataeYEL054C"] <- summary["N8_mikataeYEL054C"]
new.summary["N9_N10"] <- summary["N8_N9"]
new.summary["N10_paradoxusYEL054C"] <- summary["N9_paradoxusYEL054C"]
new.summary["N10_cerevisiaeYEL054C"] <- summary["N9_cerevisiaeYEL054C"]
}
else if (localTree == 2){
new.summary[1:3] <- summary[1:3]
new.summary["N0_N6"] <- 0.0
new.summary["N0_kluyveriYDR418W"] <- summary["N0_kluyveriYDR418W"]
new.summary["N0_N1"] <- summary["N0_N1"]
new.summary["N1_N2"] <- summary["N1_N2"]
new.summary["N1_castelliiYDR418W"] <- summary["N1_castelliiYDR418W"]
new.summary["N2_bayanusYDR418W"] <- summary["N2_bayanusYDR418W"]
new.summary["N2_N3"] <- summary["N2_N3"]
new.summary["N3_N4"] <- summary["N3_N4"]
new.summary["N3_kudriavzeviiYDR418W"] <- summary["N3_kudriavzeviiYDR418W"]
new.summary["N4_N5"] <- summary["N4_N5"]
new.summary["N4_mikataeYDR418W"] <- summary["N4_mikataeYDR418W"]
new.summary["N5_paradoxusYDR418W"] <- summary["N5_paradoxusYDR418W"]
new.summary["N5_cerevisiaeYDR418W"] <- summary["N5_cerevisiaeYDR418W"]
new.summary["N6_N7"] <- summary["N0_N6"]
new.summary["N6_castelliiYEL054C"] <- summary["N0_castelliiYEL054C"]
new.summary["N7_N8"] <- summary["N6_N7"]
new.summary["N7_bayanusYEL054C"] <- summary["N6_bayanusYEL054C"]
new.summary["N8_N9"] <- summary["N7_N8"]
new.summary["N8_kudriavzeviiYEL054C"] <- summary["N7_kudriavzeviiYEL054C"]
new.summary["N9_mikataeYEL054C"] <- summary["N8_mikataeYEL054C"]
new.summary["N9_N10"] <- summary["N8_N9"]
new.summary["N10_paradoxusYEL054C"] <- summary["N9_paradoxusYEL054C"]
new.summary["N10_cerevisiaeYEL054C"] <- summary["N9_cerevisiaeYEL054C"]
}
else if (localTree == 3){
new.summary[1:3] <- summary[1:3]
new.summary["N0_N6"] <- 0.0
new.summary["N0_kluyveriYDR418W"] <- summary["N0_kluyveriYDR418W"]
new.summary["N0_N1"] <- 0.0
new.summary["N1_N2"] <- summary["N0_N1"]
new.summary["N1_castelliiYDR418W"] <- summary["N0_castelliiYDR418W"]
new.summary["N2_bayanusYDR418W"] <- summary["N1_bayanusYDR418W"]
new.summary["N2_N3"] <- summary["N1_N2"]
new.summary["N3_N4"] <- summary["N2_N3"]
new.summary["N3_kudriavzeviiYDR418W"] <- summary["N2_kudriavzeviiYDR418W"]
new.summary["N4_N5"] <- summary["N3_N4"]
new.summary["N4_mikataeYDR418W"] <- summary["N3_mikataeYDR418W"]
new.summary["N5_paradoxusYDR418W"] <- summary["N4_paradoxusYDR418W"]
new.summary["N5_cerevisiaeYDR418W"] <- summary["N4_cerevisiaeYDR418W"]
new.summary["N6_N7"] <- summary["N0_N5"]
new.summary["N6_castelliiYEL054C"] <- summary["N0_castelliiYEL054C"]
new.summary["N7_N8"] <- summary["N5_N6"]
new.summary["N7_bayanusYEL054C"] <- summary["N5_bayanusYEL054C"]
new.summary["N8_N9"] <- summary["N6_N7"]
new.summary["N8_kudriavzeviiYEL054C"] <- summary["N6_kudriavzeviiYEL054C"]
new.summary["N9_mikataeYEL054C"] <- summary["N7_mikataeYEL054C"]
new.summary["N9_N10"] <- summary["N7_N8"]
new.summary["N10_paradoxusYEL054C"] <- summary["N8_paradoxusYEL054C"]
new.summary["N10_cerevisiaeYEL054C"] <- summary["N8_cerevisiaeYEL054C"]
}
else if (localTree == 4){
new.summary[vector.names] <- summary[vector.names]
}
return (new.summary)
}
for (IGC.geo in IGC.geo.list){
max.lnL.summary <- NULL
vector.names = rownames(get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = "")))
for (sim.num in 1:100){
max.pos <- which.max(c(get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_LocalTree_1_summary", sep = ""))["ll", sim.num],
get(paste("PAML_estimatedTau_",paste(toString(IGC.geo), ".0", sep = ""), "_LocalTree_2_summary", sep = ""))["ll", sim.num],
get(paste("PAML_estimatedTau_",paste(toString(IGC.geo), ".0", sep = ""), "_LocalTree_3_summary", sep = ""))["ll", sim.num],
get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = ""))["ll", sim.num]))
if (max.pos < 4){
new.summary <- convert.summary(max.pos, get(paste("PAML_estimatedTau", paste(toString(IGC.geo), ".0", sep = ""), "LocalTree", toString(max.pos), "summary", sep = "_"))[, sim.num], vector.names)
}
else{
new.summary <- get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = ""))[, sim.num]
}
max.lnL.summary <- cbind(max.lnL.summary, new.summary)
}
row.names(max.lnL.summary) <- row.names(get(paste("PAML_estimatedTau_", paste(toString(IGC.geo), ".0", sep = ""), "_1stTree_summary", sep = "")))
assign(paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "PAML", "maxlnL", "summary", sep = "_"), max.lnL.summary)
}
# Now check asymmetry again
# N4_N5
compare.mean.N4.N5.result <- matrix(c(mean(geo_3.0_PAML_maxlnL_summary["N4_N5", ]),
mean(geo_3.0_PAML_maxlnL_summary["N9_N10",]),
mean(geo_3.0_PAML_maxlnL_summary["N4_N5",])/mean(geo_3.0_PAML_maxlnL_summary["N9_N10",]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N4_N5", ]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N9_N10", ]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N4_N5", ])/mean(PAML_estimatedTau_3.0_1stTree_summary["N9_N10", ])),
2, 3, byrow = TRUE)
colnames(compare.mean.N4.N5.result) <- c("paralog1", "paralog2", "paralog1 / paralog2")
rownames(compare.mean.N4.N5.result) <- c("NEW", "old")
compare.sd.N4.N5.result <- matrix(c(sd(geo_3.0_PAML_maxlnL_summary["N4_N5", ]),
sd(geo_3.0_PAML_maxlnL_summary["N9_N10",]),
sd(geo_3.0_PAML_maxlnL_summary["N4_N5",])/sd(geo_3.0_PAML_maxlnL_summary["N9_N10",]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N4_N5", ]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N9_N10", ]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N4_N5", ])/sd(PAML_estimatedTau_3.0_1stTree_summary["N9_N10", ])),
2, 3, byrow = TRUE)
colnames(compare.sd.N4.N5.result) <- c("paralog1", "paralog2", "paralog1 / paralog2")
rownames(compare.sd.N4.N5.result) <- c("NEW", "old")
# N4_mikatae
compare.mean.N4.mikatae.result <- matrix(c(mean(geo_3.0_PAML_maxlnL_summary["N4_mikataeYDR418W", ]),
mean(geo_3.0_PAML_maxlnL_summary["N9_mikataeYEL054C",]),
mean(geo_3.0_PAML_maxlnL_summary["N4_mikataeYDR418W",])/mean(geo_3.0_PAML_maxlnL_summary["N9_mikataeYEL054C",]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N4_mikataeYDR418W", ]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N9_mikataeYEL054C", ]),
mean(PAML_estimatedTau_3.0_1stTree_summary["N4_mikataeYDR418W", ])/mean(PAML_estimatedTau_3.0_1stTree_summary["N9_mikataeYEL054C", ])),
2, 3, byrow = TRUE)
colnames(compare.mean.N4.mikatae.result) <- c("paralog1", "paralog2", "paralog1 / paralog2")
rownames(compare.mean.N4.mikatae.result) <- c("NEW", "old")
compare.sd.N4.mikatae.result <- matrix(c(sd(geo_3.0_PAML_maxlnL_summary["N4_mikataeYDR418W", ]),
sd(geo_3.0_PAML_maxlnL_summary["N9_mikataeYEL054C",]),
sd(geo_3.0_PAML_maxlnL_summary["N4_mikataeYDR418W",])/sd(geo_3.0_PAML_maxlnL_summary["N9_mikataeYEL054C",]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N4_mikataeYDR418W", ]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N9_mikataeYEL054C", ]),
sd(PAML_estimatedTau_3.0_1stTree_summary["N4_mikataeYDR418W", ])/sd(PAML_estimatedTau_3.0_1stTree_summary["N9_mikataeYEL054C", ])),
2, 3, byrow = TRUE)
colnames(compare.sd.N4.mikatae.result) <- c("paralog1", "paralog2", "paralog1 / paralog2")
rownames(compare.sd.N4.mikatae.result) <- c("NEW", "old")
compare.mean.N4.N5.result
compare.sd.N4.N5.result
compare.mean.N4.mikatae.result
compare.sd.N4.mikatae.result
source('~/.active-rstudio-document', echo=TRUE)
plot(IGC.geo.list, maxlnL.PAML.omega.mean)
maxlnL.PAML.omega.mean
source('~/.active-rstudio-document', echo=TRUE)
