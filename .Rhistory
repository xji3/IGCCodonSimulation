paml.path <- "/Users/Xiang/GitFolders/IGCCodonSimulation/"
IGC.geo.list <- c(3.0, 10.0, 50.0, 100.0, 500.0)
num.sim = 100
paralog = "YDR418W_YEL054C"
# Now read in PAML analysis of these simulated data set
data.path <- paste(paralog, "",sep = "/")
for (IGC.geo in IGC.geo.list){
summary_mat <- NULL
IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
paml.file <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "paml", "summary.txt", sep = "_")
for (sim.num in 0:(num.sim - 1)){
summary_file <- paste(paml.path, file.name, sep = "")
if (file.exists(summary_file)){
all <- readLines(summary_file, n = -1)
col.names <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "sim", toString(sim.num), sep = "_")
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- cbind(summary_mat, as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names)))
}
}
assign(paste("pIGC", paste(toString(IGC.geo), ".0", sep = ""), "summary", sep = "_"), summary_mat)
}
summary_mat <- NULL
IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "paml", "summary.txt", sep = "_")
for (sim.num in 0:(num.sim - 1)){
summary_file <- paste(paml.path, file.name, sep = "")
if (file.exists(summary_file)){
all <- readLines(summary_file, n = -1)
col.names <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "sim", toString(sim.num), sep = "_")
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- cbind(summary_mat, as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names)))
}
}
assign(paste("pIGC", paste(toString(IGC.geo), ".0", sep = ""), "summary", sep = "_"), summary_mat)
row.names
paml.path <- "/Users/Xiang/GitFolders/IGCCodonSimulation/"
IGC.geo.list <- c(3.0, 10.0, 50.0, 100.0, 500.0)
#IGC.geo.list <- c(1.0)
num.sim = 100
paralog = "YDR418W_YEL054C"
# Now read in PAML analysis of these simulated data set
data.path <- paste(paralog, "",sep = "/")
for (IGC.geo in IGC.geo.list){
summary_mat <- NULL
IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "paml", "summary.txt", sep = "_")
for (sim.num in 0:(num.sim - 1)){
summary_file <- paste(paml.path, file.name, sep = "")
if (file.exists(summary_file)){
all <- readLines(summary_file, n = -1)
col.names <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "sim", toString(sim.num), sep = "_")
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- cbind(summary_mat, as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names)))
}
}
assign(paste("pIGC", paste(toString(IGC.geo), ".0", sep = ""), "summary", sep = "_"), summary_mat)
}
col.names
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- cbind(summary_mat, as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names)))
summary_mat
mean(summary_mat[1,])
sd(summary_mat[1,])
mean(summary_mat[2,])
sd(summary_mat[2,])
data.path <- paste(paralog, "",sep = "/")
for (IGC.geo in IGC.geo.list){
summary_mat <- NULL
IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "paml", "summary.txt", sep = "_")
for (sim.num in 0:(num.sim - 1)){
summary_file <- paste(paml.path, file.name, sep = "")
if (file.exists(summary_file)){
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- cbind(summary_mat, as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names)))
}
}
assign(paste("PAML", paste(toString(IGC.geo), ".0", sep = ""), "summary", sep = "_"), summary_mat)
}
rm(list=ls())  # clean up workspace
load("/Users/Xiang/GitFolders/IGCCodonSimulation/All.RData")
# paml.path <- "/Users/Xiang/GitFolders/IGCCodonSimulation/"
# IGC.geo.list <- c(3.0)
#
# # Read in new PAML results
# data.path <- paste(paralog, "",sep = "/")
# for (IGC.geo in IGC.geo.list){
#   summary_mat <- NULL
#   IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
#   file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "estimatedTau", "paml", "unrooted", "1stTree", "summary.txt", sep = "_")
#   for (sim.num in 0:(num.sim - 1)){
#     summary_file <- paste(paml.path, file.name, sep = "")
#     if (file.exists(summary_file)){
#       all <- readLines(summary_file, n = -1)
#       col.names <- strsplit(all[1], ' ')[[1]][-1]
#       row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
#       summary_mat <- as.matrix(read.table(summary_file,
#                                           row.names = row.names,
#                                           col.names = col.names))
#
#       }
#     }
#   assign(paste("PAML", "estimatedTau", paste(toString(IGC.geo), ".0", sep = ""), "1stTree", "summary", sep = "_"), summary_mat)
# }
#
# for (IGC.geo in IGC.geo.list){
#   summary_mat <- NULL
#   IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
#   file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "estimatedTau", "paml", "unrooted", "2ndTree", "summary.txt", sep = "_")
#   for (sim.num in 0:(num.sim - 1)){
#     summary_file <- paste(paml.path, file.name, sep = "")
#     if (file.exists(summary_file)){
#       all <- readLines(summary_file, n = -1)
#       col.names <- strsplit(all[1], ' ')[[1]][-1]
#       row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
#       summary_mat <- as.matrix(read.table(summary_file,
#                                           row.names = row.names,
#                                           col.names = col.names))
#
#       }
#     }
#   assign(paste("PAML", "estimatedTau", paste(toString(IGC.geo), ".0", sep = ""), "2ndTree", "summary", sep = "_"), summary_mat)
# }
#
# for (IGC.geo in IGC.geo.list){
#   summary_mat <- NULL
#   IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
#   file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "10Tau", "paml", "unrooted", "1stTree", "summary.txt", sep = "_")
#   for (sim.num in 0:(num.sim - 1)){
#     summary_file <- paste(paml.path, file.name, sep = "")
#     if (file.exists(summary_file)){
#       all <- readLines(summary_file, n = -1)
#       col.names <- strsplit(all[1], ' ')[[1]][-1]
#       row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
#       summary_mat <- as.matrix(read.table(summary_file,
#                                           row.names = row.names,
#                                           col.names = col.names))
#
#       }
#     }
#   assign(paste("PAML", "10Tau", paste(toString(IGC.geo), ".0", sep = ""), "1stTree", "summary", sep = "_"), summary_mat)
#   }
#
# for (IGC.geo in IGC.geo.list){
#   summary_mat <- NULL
#   IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
#   file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "10Tau", "paml", "unrooted", "2ndTree", "summary.txt", sep = "_")
#   for (sim.num in 0:(num.sim - 1)){
#     summary_file <- paste(paml.path, file.name, sep = "")
#     if (file.exists(summary_file)){
#       all <- readLines(summary_file, n = -1)
#       col.names <- strsplit(all[1], ' ')[[1]][-1]
#       row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
#       summary_mat <- as.matrix(read.table(summary_file,
#                                           row.names = row.names,
#                                           col.names = col.names))
#
#       }
#     }
#   assign(paste("PAML", "10Tau", paste(toString(IGC.geo), ".0", sep = ""), "2ndTree", "summary", sep = "_"), summary_mat)
# }
#
# save.image("/Users/Xiang/GitFolders/IGCCodonSimulation/All.RData")
View(PAML_estimatedTau_3.0_1stTree_summary)
View(PAML_estimatedTau_3.0_1stTree_summary)
summary(PAML_estimatedTau_3.0_1stTree_summary["kappa", ] - PAML_estimatedTau_3.0_2ndTree_summary["kappa", ])
sd(PAML_estimatedTau_3.0_1stTree_summary["kappa", ] - PAML_estimatedTau_3.0_2ndTree_summary["kappa", ])
summary(PAML_estimatedTau_3.0_1stTree_summary["omega", ] - PAML_estimatedTau_3.0_2ndTree_summary["omega", ])
sd(PAML_estimatedTau_3.0_1stTree_summary["omega", ] - PAML_estimatedTau_3.0_2ndTree_summary["omega", ])
row.names(PAML_estimatedTau_3.0_1stTree_summary)
PAML_3.0_summary[, 1]
PAML_estimatedTau_3.0_1stTree_summary[, 1]
rm(list=ls())  # clean up workspace
load("/Users/Xiang/GitFolders/IGCCodonSimulation/All.RData")
paml.path <- "/Users/Xiang/GitFolders/IGCCodonSimulation/"
IGC.geo.list <- c(3.0)
# Read in new PAML results
data.path <- paste(paralog, "",sep = "/")
for (IGC.geo in IGC.geo.list){
summary_mat <- NULL
IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "estimatedTau", "paml", "unrooted", "1stTree", "summary.txt", sep = "_")
for (sim.num in 0:(num.sim - 1)){
summary_file <- paste(paml.path, file.name, sep = "")
if (file.exists(summary_file)){
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
}
}
assign(paste("PAML", "estimatedTau", paste(toString(IGC.geo), ".0", sep = ""), "1stTree", "summary", sep = "_"), summary_mat)
}
for (IGC.geo in IGC.geo.list){
summary_mat <- NULL
IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "estimatedTau", "paml", "unrooted", "2ndTree", "summary.txt", sep = "_")
for (sim.num in 0:(num.sim - 1)){
summary_file <- paste(paml.path, file.name, sep = "")
if (file.exists(summary_file)){
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
}
}
assign(paste("PAML", "estimatedTau", paste(toString(IGC.geo), ".0", sep = ""), "2ndTree", "summary", sep = "_"), summary_mat)
}
for (IGC.geo in IGC.geo.list){
summary_mat <- NULL
IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "10Tau", "paml", "unrooted", "1stTree", "summary.txt", sep = "_")
for (sim.num in 0:(num.sim - 1)){
summary_file <- paste(paml.path, file.name, sep = "")
if (file.exists(summary_file)){
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
}
}
assign(paste("PAML", "10Tau", paste(toString(IGC.geo), ".0", sep = ""), "1stTree", "summary", sep = "_"), summary_mat)
}
for (IGC.geo in IGC.geo.list){
summary_mat <- NULL
IGC.geo.path <- paste("IGCgeo_", toString(IGC.geo), ".0/", sep = "")
file.name <- paste("geo", paste(toString(IGC.geo), ".0", sep = ""), "10Tau", "paml", "unrooted", "2ndTree", "summary.txt", sep = "_")
for (sim.num in 0:(num.sim - 1)){
summary_file <- paste(paml.path, file.name, sep = "")
if (file.exists(summary_file)){
all <- readLines(summary_file, n = -1)
col.names <- strsplit(all[1], ' ')[[1]][-1]
row.names <- strsplit(all[length(all)], ' ')[[1]][-1]
summary_mat <- as.matrix(read.table(summary_file,
row.names = row.names,
col.names = col.names))
}
}
assign(paste("PAML", "10Tau", paste(toString(IGC.geo), ".0", sep = ""), "2ndTree", "summary", sep = "_"), summary_mat)
}
save.image("/Users/Xiang/GitFolders/IGCCodonSimulation/All.RData")
PAML_3.0_summary[, 1]
PAML_estimatedTau_3.0_1stTree_summary[, 1]
